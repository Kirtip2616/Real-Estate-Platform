"use strict";(self.webpackChunkhousing_demand=self.webpackChunkhousing_demand||[]).push([[46323],{83652:(e,t,a)=>{a.d(t,{default:()=>D});var r=a(37900),l=a(79181),n=a(17011),i=a(61553),o=a(8499),c=a(66777),d=a(77347),s=a(47451),p=a(29012),y=a(49843),h=a(49943),u=a(19094),g=a(42181),T=a(42788);const v=(0,u.Z)((()=>a.e(11296).then(a.bind(a,71628))),{type:"local",container:"housing.demand",module:"common/components/PriceTrensNew/NoPriceTrends"}),D=(0,l.Z)({props:e=>{let{filters:{service:t,entities:a}={},propertyDetails:r,meta:{selectedItemsModalPriceTrends:{data:l,lastUpdated:n}={},priceTrendsData:i,localityTrendsData:o}={}}=e;return{propertyDetails:r,service:t,entities:a,selectedItems:l,lastUpdated:n,priceTrendsData:i,localityTrendsData:o}},actions:{emptySelectedItems:s.Mp,fetchLocalityPriceTrends:y.W4,fetchLocalityDetails:h.Z}})((function PriceTrendsDesktop(e){var t,a,l,s;let{propertyDetails:h,selectedItems:u=[],entities:D=[],service:m="buy",lastUpdated:L,emptySelectedItems:f,fetchLocalityPriceTrends:k,priceTrendsData:E={},localityTrendsData:P={},fetchLocalityDetails:I,ssr:C=!1}=e;const{details:{title:N,listingId:j,coverImage:{src:w}={},details:{localityInfo:{priceTrendsUrl:S="",entity:{name:x=""}={}}={},config:{propertyConfig:F=[]}={}}={},nearbyLocalityUuids:_=[]}={},projectPriceTrends:b=[]}=h||{};let G=!1;const R=null==F||null===(t=F[0])||void 0===t?void 0:t.propertyTypeId,M=(null===(a=y.zl[m][R])||void 0===a?void 0:a.label)||(null===(l=y.zl[m][1])||void 0===l?void 0:l.label),O=D.filter((e=>{let{name:t}=e;return t===x})),{id:U}=O[0]||{},Z=(0,c.Z)(d.Z),A=(b||[])[0]||E||{},{trend:Y=[]}=A,[z,B]=(0,r.useState)({value:n.Jy,clicked:!1}),[W,$]=(0,r.useState)(C?P:{}),[J,K]=(0,r.useState)({nearLocality1:{},nearLocality2:{},nearLocality3:{},nearLocality4:{},nearLocality5:{}}),[V,q]=(0,r.useState)(C||!1),{nearLocality1:H={},nearLocality2:Q={},nearLocality3:X={},nearLocality4:ee={},nearLocality5:te={}}=J,[ae,re]=(0,r.useState)([]),le=u.length;(0,r.useEffect)((()=>{["nearLocality3","nearLocality4","nearLocality5"].forEach(((e,t)=>{const{name:a,priceTrend:r={},priceTrend:{averagePrice:l,percentageGrowth:n}={}}=u[t]||{};K((t=>({...t,[e]:{name:a,avgRate:{value:l},percentGrowth:parseFloat(n),...r}||{}})))}))}),[L]);const ne=(0,r.useMemo)((()=>({...n.Iz})),[]);(0,r.useEffect)((()=>{if(C)return;f();const e=[U&&k({poly:U,service:m}),_[0]&&k({poly:_[0],service:m}),_[1]&&k({poly:_[1],service:m}),_[0]&&I(_[0]),_[1]&&I(_[1])];Promise.all(e).then((e=>{let[{priceTrends:t={}}={},{priceTrends:a={}}={},{priceTrends:r={}}={},l={},n={}]=e;const i=null==l?void 0:l.localityName,o=null==n?void 0:n.localityName;q(!0),$(t),K((e=>({...e,nearLocality1:{...a,localityName1:i}||{},nearLocality2:{...r,localityName2:o}||{}})))}))}),[]);const ie=!(null===(s=W.localityTrend)||void 0===s||!s.length),oe=!!Y.length,ce=!ie&&!oe,{percentGrowth:de,avgRate:{value:se}={}}=(Y.length?A:W)||{},pe=(0,r.useMemo)((()=>{var e,t,a,r,l;return{project:{check:!!Y.length,data:A,strokeColor:"#E3AF64",title:N,trend:Y,types:"Project"},locality:{check:ie&&(0===le||!Y.length),data:{...W,trend:W.localityTrend,percentGrowth:W.percentageGrowth}||{},strokeColor:"#75C7F5",title:x,trend:W.localityTrend,types:"Locality"},nearLocality1:{check:ce&&0===le&&!(null===(e=H.localityTrend)||void 0===e||!e.length),data:{...H,trend:H.localityTrend,percentGrowth:H.percentageGrowth}||{},strokeColor:"#BE95FF",title:H.name,trend:H.localityTrend,types:"Locality"},nearLocality2:{check:ce&&0===le&&!(null===(t=Q.localityTrend)||void 0===t||!t.length),data:{...Q,trend:Q.localityTrend,percentGrowth:Q.percentageGrowth}||{},strokeColor:"#44DFDC",title:Q.name,trend:Q.localityTrend,types:"Locality"},nearLocality3:{check:le>0&&!(null===(a=X.trend)||void 0===a||!a.length),data:X,strokeColor:Y.length?"#75C7F5":"#E3AF64",title:X.name,trend:X.trend,types:"Project"},nearLocality4:{check:le>0&&!(null===(r=ee.trend)||void 0===r||!r.length),data:ee,strokeColor:"#BE95FF",title:ee.name,trend:ee.trend,types:"Project"},nearLocality5:{check:le>0&&!(null===(l=te.trend)||void 0===l||!l.length),data:te,strokeColor:"#44DFDC",title:te.name,trend:te.trend,types:"Project"}}}),[h,u,J]),ye=(0,r.useMemo)((()=>n.Zr.filter((e=>{var t;return null===(t=pe[e])||void 0===t?void 0:t.check}))),[pe]),getGraphRenderedData=e=>{var t;let{index:a,modifiedTrendsData:r}=e;const l=(0,n.D6)({ptDetailsObj:pe[ye[a]],selectedYears:z.value,key:0==a?"price":`price${a}`});return l.trend=(null==r?void 0:r.slice(-4*z.value))||l.trend,{renderedData:l,originalTrendData:r||(null===(t=pe[ye[a]])||void 0===t?void 0:t.trend),headingTitle:l.title}},{renderedData:he,originalTrendData:ue,headingTitle:ge}=(0,r.useMemo)((()=>{const e=[];let t=[];const a=[];let r=[];if(ye.length>1&&(r=(0,n.KN)(ye,pe)),r.length>=1&&ye.forEach(((l,n)=>{const{renderedData:i,originalTrendData:o,headingTitle:c}=getGraphRenderedData({index:n,modifiedTrendsData:r});e.push(i),t=o,a.push(c)})),1===ye.length||0===r.length){const{renderedData:r,originalTrendData:l,headingTitle:n}=getGraphRenderedData({index:0});e.push(r),t=l,a.push(n)}return 0==ye.length&&0==r.length&&V&&(G=!0),{renderedData:e,originalTrendData:t,headingTitle:a}}),[ye,z]),Te=(0,r.useMemo)((()=>`Price Trends for ${ge.join(" vs. ")}`),[ge]),{DROPDOWN_OPTIONS:ve,DROPDOWN_LABEL:De,SELECTED_YEARS:me}=(0,r.useMemo)((()=>(0,n.eL)({originalTrendData:ue})),[ue]);return(0,T.jsx)("section",{className:i.p5,"data-testid":"price-trend-section"},(0,T.jsx)(p.default,{onEnter:()=>{var e;Y.length&&Z("PRICE_TRENDS_SEEN",{trackingDetails:ne}),(null===(e=W.localityTrend)||void 0===e?void 0:e.length)&&Z("LOCALITY_PRICE_TRENDS_SEEN",{trackingDetails:ne})}}),V?G?(0,T.jsx)(v,{priceTrendsUrl:S,localityName:x,style:i.Lw,trackingDetails:ne,renderedData:he,selectedService:"buy"}):(0,T.jsx)(o.default,{renderedData:he,priceTrendsUrl:S,originalProjectListingId:j,setSelectedYears:B,selectedYears:z.clicked?z.value:me,projectTitle:N,localityName:x,heading:Te,dropDownText:De,options:ve,trackingDetails:ne,pageType:"Project_price_trend",listingId:Y.length?j:U,selectedItems:u,preData:{id:Y.length?j:U,avgRate:se,name:Y.length?N:x,loaded:!0,service:m,percentageGrowth:de?de.toFixed(2):null==W?void 0:W.percentageGrowth,image:w},disabledIndex:ae,setDisableIndex:re,style:i.p5,propertyTypeValue:M}):(0,T.jsx)(g.Z,{height:"530px"}))}))}}]);